from __future__ import annotations # –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∞–º –∫–ª–∞—Å—Å –≤ —Å–∞–º–æ–º –∫–ª–∞—Å—Å–µ
from math import lcm               # –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –æ–±—â–µ–µ –∫—Ä–∞—Ç–Ω–æ–µ


class Substitution:
    # –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ –∏–ª–∏ —Å–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –∫–∞–∫ —Å–ø–∏—Å–æ–∫ self.s
    def __init__(self, s: tuple[int] | list[int]):
        self.s = list(s)
        for i in self.s:
            assert 0 < i and i <= len(self.s) # –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –æ—Ç 1 –¥–æ len(list)


    # —Å–æ–∑–¥–∞–µ—Ç –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É –∏–∑ —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ —á–∏—Å–ª–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø—Ä–æ–±–µ–ª–æ–º: "1 3 2" -> [1, 3, 2]
    # static —á—Ç–æ–±—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—É—Å—Ç—É—é –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É
    @staticmethod
    def from_string(s: str, sep: str = " ") -> Substitution:
        return Substitution(map(int, s.split(sep)))
    

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É (–∫–æ–ø–∏—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏)
    def inverted(self) -> Substitution:
        return self.copy().invert()


    # –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É, –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É
    def invert(self) -> Substitution:
        s = self.s.copy()
        for i, e in enumerate(s):
            self.s[e - 1] = i + 1
        return self # –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∞–º –æ–±—ä–µ–∫—Ç
    

    # **
    # –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å -> –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É 3 —Ä–∞–∑–∞ –ø–æ–¥—Ä—è–¥
    def __pow__(self, n: int):
        if type(n) is float:
            raise TypeError("") # –æ—à–∏–±–∫–∞ –¥–ª—è –Ω–µ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª
        
        # —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–ø–∏—è –∏ –æ–Ω–∞ —É–º–Ω–æ—Å–∞–∂–µ—Ç—Å—è —Å–∞–º–∞ –Ω–∞ —Å–µ–±—è n-1 —Ä–∞–∑
        result = self.copy()
        for i in range(abs(n) - 1):
            result *= self

        # –µ—Å–ª–∏ —Å—Ç–µ–ø–µ–Ω—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è - –±–µ—Ä—ë—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞
        if n < 0:
            result.invert()
        return result


    # **=
    # –≤–æ–∑–≤–µ—Å—Ç–∏ –≤ —Å—Ç–µ–ø–µ–Ω—å –∏ –∑–∞–ø–∏—Å–∞—Ç—å –≤ —Ç—É –∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∞–º –æ–±—ä–µ–∫—Ç –≤–º–µ—Å—Ç–æ –∫–æ–ø–∏–∏, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ **
    def __ipow__(self, n: int):
        if type(n) is float:
            raise TypeError()
        copy = self.copy()
        for i in range(abs(n) - 1):
            self *= copy

        if n < 0:
            self.invert()
        return self


    # —Å–æ–∑–¥–∞–µ—Ç –∫–æ–ø–∏—é - —Ç.–µ –Ω–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å —Ç–µ–º–∏ –∂–µ —á–∏—Å–ª–∞–º–∏, –Ω–æ –≤ –ø–∞–º—è—Ç–∏ - —ç—Ç–æ —É–∂–µ –¥—Ä—É–≥–æ–π –æ–±—ä–µ–∫—Ç
    # –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç –∫–∞–∫ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ =
    def copy(self) -> Substitution:
        return Substitution(self.s.copy())


    # –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è (print)
    def __str__(self):
        return " ".join(map(str, self.s))


    # *
    # –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ * - —É–º–Ω–æ–∂–µ–Ω–∏–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ–∫ (–∫–æ–º–ø–æ–∑–∏—Ü–∏—è)
    # –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—É—é
    # a.__mul__(b) - —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è b, –ø–æ—Ç–æ–º –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ a. –ö–æ–º–ø–æ–∑–∏—Ü–∏–∏ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –∏–¥—É—Ç —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ
    def __mul__(self, other: Substitution):
        result = self.copy()
        for i in range(len(result)):
            # –∏–Ω–¥–µ–∫—Å —Å –Ω—É–ª—è, –≤ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–µ —á–∏—Å–ª–∞ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è 1, –ø–æ—ç—Ç–æ–º—É result[i]-1
            result.s[i] = other[result[i] - 1]
        return result

    # –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –∫–∞–∫ –∫ —Å–ø–∏—Å–∫—É, œÉ[0] - –≤–µ—Ä–Ω–µ—Ç –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
    def __getitem__(self, key: int):
        return self.s[key]


    # –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å len() –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ–∫
    def __len__(self):
        return len(self.s)


    # –º–µ—Ç–æ–¥ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ —Ü–∏–∫–ª—ã
    def to_cycles(self) -> list[list[int]]:
        visited = [False] * len(self.s) # –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        cycles = [] # —Å–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤
        # –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è —Ü–µ–ø–æ—á–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, –ø–æ–∫–∞ –Ω–µ –≤–µ—Ä–Ω–µ–º—Å—è –∫ –Ω–∞—á–∞–ª—É, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —Ü–∏–∫–ª—ã –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
        for i in range(len(self)):
            j = i
            cycle = []
            while not visited[j]:
                cycle.append(j + 1)
                visited[j] = True
                j = self[j] - 1
            if len(cycle) > 0:
                cycles.append(cycle)
        
        return cycles
    

    # ord() –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ—Ä—è–¥–æ–∫ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ - –Ω–∞–∏–º–µ–Ω—å—à–µ–µ —á–∏—Å–ª–æ, —Å—Ç–µ–ø–µ–Ω—å, –≤ –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –≤–æ–∑–≤–µ—Å—Ç–∏ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∂–¥–µ—Å—Ç–≤–µ–Ω–Ω—É—é (-1)
    # * - —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞
    # c—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –ù–û–ö –¥–ª–∏–Ω –≤—Å–µ—Ö —Ü–∏–∫–ª–æ–≤
    def ord(self) -> int:
        cycles = self.to_cycles()
        return lcm(*map(len, cycles)) 


'''
# –í–æ–∑—å–º–∏ –¥–ª–∏–Ω—É –∫–∞–∂–¥–æ–≥–æ —Ü–∏–∫–ª–∞ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –Ω–∞–π–¥–∏ –∏—Ö –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –æ–±—â–µ–µ –∫—Ä–∞—Ç–Ω–æ–µ.
# –≠—Ç–æ –∏ –µ—Å—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–µ—Ä–Ω—ë—Ç –≤—Å—ë –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ.

–û—Ç–ª–∏—á–Ω–æ üëå
–î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º –ø—Ä–∏–º–µ—Ä –ø–æ—à–∞–≥–æ–≤–æ ‚Äî —á—Ç–æ–±—ã —Ç—ã —Ç–æ—á–Ω–æ –ø–æ–Ω—è–ª, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ord() –∏ –∑–∞—á–µ–º —Ç–∞–º lcm(*map(len, cycles)).

üî¢ –ü—Ä–∏–º–µ—Ä –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏

–í–æ–∑—å–º—ë–º –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É

tau = Substitution([2, 3, 1, 5, 4])


–≠—Ç–æ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–∏—Å–µ–ª –æ—Ç 1 –¥–æ 5.

üîç –®–∞–≥ 1. –†–∞–∑–ª–æ–∂–∏–º –Ω–∞ —Ü–∏–∫–ª—ã (to_cycles())

–ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —ç–ª–µ–º–µ–Ω—Ç—ã ¬´–ø–µ—Ä–µ—Ö–æ–¥—è—Ç¬ª –æ–¥–∏–Ω –≤ –¥—Ä—É–≥–æ–π:

–ß–∏—Å–ª–æ	–ö—É–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç (tau[i])
1 ‚Üí 2	
2 ‚Üí 3	
3 ‚Üí 1	
4 ‚Üí 5	
5 ‚Üí 4	

–¢–µ–ø–µ—Ä—å –Ω–∞–π–¥—ë–º —Ü–∏–∫–ª—ã:

–ù–∞—á–∏–Ω–∞–µ–º —Å 1:

1 ‚Üí 2 ‚Üí 3 ‚Üí 1
—Ü–∏–∫–ª: [1, 2, 3]


–°–ª–µ–¥—É—é—â–µ–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ ‚Äî 4:

4 ‚Üí 5 ‚Üí 4
—Ü–∏–∫–ª: [4, 5]


‚úÖ –ü–æ–ª—É—á–∞–µ–º:

cycles = [[1, 2, 3], [4, 5]]

üî¢ –®–∞–≥ 2. –ü–æ—Å—á–∏—Ç–∞–µ–º –¥–ª–∏–Ω—ã —Ü–∏–∫–ª–æ–≤
map(len, cycles)


–¥–∞—ë—Ç:

[3, 2]


‚Äî –ø–µ—Ä–≤—ã–π —Ü–∏–∫–ª –¥–ª–∏–Ω–æ–π 3, –≤—Ç–æ—Ä–æ–π ‚Äî –¥–ª–∏–Ω–æ–π 2.

‚öôÔ∏è –®–∞–≥ 3. –í—ã—á–∏—Å–ª–∏–º –ù–û–ö (–Ω–∞–∏–º–µ–Ω—å—à–µ–µ –æ–±—â–µ–µ –∫—Ä–∞—Ç–Ω–æ–µ)
lcm(*[3, 2])  # —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ lcm(3, 2)


–ù–∞–∏–º–µ–Ω—å—à–µ–µ –æ–±—â–µ–µ –∫—Ä–∞—Ç–Ω–æ–µ 3 –∏ 2 ‚Äî —ç—Ç–æ 6.

‚úÖ –®–∞–≥ 4. –†–µ–∑—É–ª—å—Ç–∞—Ç
tau.ord() == 6


–¢–æ –µ—Å—Ç—å:

–ï—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ç—É –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É 6 —Ä–∞–∑ –ø–æ–¥—Ä—è–¥ (tau ** 6), –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–Ω–æ–≤–∞ –æ–∫–∞–∂—É—Ç—Å—è –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö ‚Äî –ø–æ–ª—É—á–∏—Ç—Å—è —Ç–æ–∂–¥–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞.

üß† –ö–æ—Ä–æ—Ç–∫–æ —Å—É—Ç—å:
–≠—Ç–∞–ø	–ß—Ç–æ –¥–µ–ª–∞–µ—Ç
to_cycles()	–ù–∞—Ö–æ–¥–∏—Ç —Ü–∏–∫–ª—ã –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
map(len, cycles)	–°—á–∏—Ç–∞–µ—Ç –¥–ª–∏–Ω—É –∫–∞–∂–¥–æ–≥–æ —Ü–∏–∫–ª–∞
lcm(*...)	–ù–∞—Ö–æ–¥–∏—Ç –æ–±—â–µ–µ ¬´–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ¬ª –≤—Å–µ—Ö —Ü–∏–∫–ª–æ–≤
ord()	–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç—Ç–æ —á–∏—Å–ª–æ ‚Äî –ø–æ—Ä—è–¥–æ–∫ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
'''